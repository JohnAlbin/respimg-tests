(function(w){"use strict";if(!!(w.document.createElement("picture")&&w.document.createElement("source")&&w.HTMLPictureElement)){return}w.picturefill=function(){function _copyAttributes(src,tar){if(src.getAttribute("width")&&src.getAttribute("height")){tar.width=src.getAttribute("width");tar.height=src.getAttribute("height")}}var ps=w.document.getElementsByTagName("picture");for(var i=0,il=ps.length;i<il;i++){var sources=ps[i].getElementsByTagName("source");var picImg=null;var matches=[];if(!sources.length){var picText=ps[i].innerHTML;var frag=w.document.createElement("div");var srcs=picText.replace(/(<)source([^>]+>)/gim,"$1div$2").match(/<div[^>]+>/gim);frag.innerHTML=srcs.join("");sources=frag.getElementsByTagName("div")}for(var j=0,jl=sources.length;j<jl;j++){var media=sources[j].getAttribute("media");if(!media||w.matchMedia&&w.matchMedia(media).matches){matches.push(sources[j])}}if(matches.length){var match=matches.pop();var srcset=match.getAttribute("srcset");picImg=ps[i].getElementsByTagName("img")[0];if(!picImg){picImg=w.document.createElement("img");picImg.alt=ps[i].getAttribute("alt");ps[i].appendChild(picImg)}if(srcset){var screenRes=w.devicePixelRatio||1;sources=srcset.split(", ");for(var res=sources.length,r=res-1;r>=0;r--){var source=sources[r].replace(/^\s*/,"").replace(/\s*$/,"").split(" ");var resMatch=parseFloat(source[1],10);if(screenRes>=resMatch){if(picImg.getAttribute("src")!==source[0]){var newImg=document.createElement("img");newImg.src=source[0];newImg.onload=function(){var w=this.cloneNode(true).width;if(w>0){this.width=w/resMatch}};_copyAttributes(match,newImg);picImg.parentNode.replaceChild(newImg,picImg)}break}}}else{picImg.src=match.getAttribute("src");_copyAttributes(match,picImg)}}}};if(w.addEventListener){w.addEventListener("resize",w.picturefill,false);w.addEventListener("DOMContentLoaded",function(){w.picturefill();w.removeEventListener("load",w.picturefill,false)},false);w.addEventListener("load",w.picturefill,false)}else if(w.attachEvent){w.attachEvent("onload",w.picturefill)}})(this);